text
keyboard --vckeymap=us --xlayouts='us'
lang en_US.UTF-8

network  --bootproto=dhcp --device=enX0 --ipv6=auto --activate
network  --hostname=template-centos10-uefi-lvm

repo --name="AppStream" --baseurl=file:///run/install/repo/AppStream
%packages
@^minimal-environment
cloud-init
%end


ignoredisk --only-use=xvda
clearpart --none --initlabel
part /boot/efi --fstype="efi" --ondisk=xvda --size=512 --fsoptions="umask=0077,shortname=winnt"
part /boot --fstype="xfs" --ondisk=xvda --size=1024
part pv.0 --fstype="lvmpv" --ondisk=xvda --size=1 --grow
volgroup rootvg --pesize=4096 pv.0
logvol / --fstype="xfs" --size=16384 --name=root --vgname=rootvg
logvol swap --fstype="swap" --size=4096 --name=swap --vgname=rootvg


rootpw --lock
user --groups=wheel --name=template --password=centos10-uefi-lvm --plaintext --gecos="CentOS 10 UEFI/LVM Template User"

eula --agreed
firstboot --disable

%addon com_redhat_kdump --enable --reserve-mb='auto'
%end

%post --log=/root/ks-post.log
dnf install -y https://gitlab.com/xen-project/xen-guest-agent/-/jobs/6041686376/artifacts/raw/RPMS/x86_64/xen-guest-agent-0.4.0-0.fc37.x86_64.rpm
systemctl enable xen-guest-agent.service
%end

reboot
